# –ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã MikroTik

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞:** 10 –¥–µ–∫–∞–±—Ä—è 2025
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 15 –¥–µ–∫–∞–±—Ä—è 2025
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.3
**–ê—É–¥–∏—Ä—É–µ–º–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:** –°–µ—Ç—å MikroTik RouterOS 7.x
**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –º–æ–¥—É–ª–µ–π:** 29+ —Ñ–∞–π–ª–æ–≤ (.rsc)
**–ù–æ–≤—ã–µ –º–æ–¥—É–ª–∏ (v1.2):** firewall_complete.rsc, nginx-certbot/, wifi/, xray/

---

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [Executive Summary](#executive-summary)
2. [–û–±–∑–æ—Ä –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã](#–æ–±–∑–æ—Ä-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã)
3. [–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –∞—É–¥–∏—Ç–∞](#–º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è-–∞—É–¥–∏—Ç–∞)
4. [–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ-–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
5. [–°—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#—Å—Ä–µ–¥–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
6. [–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã](#—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ-–ø—Ä–æ–±–ª–µ–º—ã)
7. [–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã](#–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ-–∞—Å–ø–µ–∫—Ç—ã)
8. [–ú–∞—Ç—Ä–∏—Ü–∞ —Ä–∏—Å–∫–æ–≤](#–º–∞—Ç—Ä–∏—Ü–∞-—Ä–∏—Å–∫–æ–≤)
9. [–ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è](#–ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è-—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è)

---

## Executive Summary

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: üü¢ –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø (v1.3 - –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã)

**–ò—Å—Ö–æ–¥–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ (v1.0):** üü° –°–†–ï–î–ù–Ø–Ø
**–û—Ü–µ–Ω–∫–∞ v1.2:** üü¢ –•–û–†–û–®–ê–Ø (3 –∏–∑ 6 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º —Ä–µ—à–µ–Ω—ã)
**–¢–µ–∫—É—â–∞—è –æ—Ü–µ–Ω–∫–∞ (v1.3):** üü¢ **–ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø** (**–í–°–ï 6 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º —Ä–µ—à–µ–Ω—ã ‚úÖ - 100%**)

–ü—Ä–æ–≤–µ–¥—ë–Ω –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞—É–¥–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ MikroTik RouterOS, –≤–∫–ª—é—á–∞—é—â–µ–π 29+ –º–æ–¥—É–ª–µ–π –∏ –æ—Ö–≤–∞—Ç—ã–≤–∞—é—â–µ–π:
- –ë–∞–∑–æ–≤—É—é —Å–µ—Ç–µ–≤—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É
- WiFi (–æ—Å–Ω–æ–≤–Ω–∞—è –∏ –≥–æ—Å—Ç–µ–≤–∞—è —Å–µ—Ç–∏)
- VPN (SSTP, WireGuard site-to-site)
- BGP –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏
- Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (xray, nginx, certbot)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

### –ö–ª—é—á–µ–≤—ã–µ –Ω–∞—Ö–æ–¥–∫–∏

**üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:** 6 (**–í–°–ï —Ä–µ—à–µ–Ω—ã ‚úÖ –≤ v1.0-1.3**)
**üü° –°—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:** 9 (5 —Ä–µ—à–µ–Ω—ã ‚úÖ –≤ v1.2-1.3)
**üîµ –ù–∏–∑–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:** 5
**‚úÖ –•–æ—Ä–æ—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏:** 8

**–°—Ç–∞—Ç—É—Å v1.3 - —Ä–µ—à–µ–Ω–æ 10 –ø—Ä–æ–±–ª–µ–º:**
- ‚úÖ **CRIT-01: Credentials Management - –†–ï–®–ï–ù–û** (—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è v1.3)
- ‚úÖ **CRIT-05: ACL —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è - –†–ï–®–ï–ù–û** (—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è v1.3)
- ‚úÖ **CRIT-06: CVE-2025-61481 - –†–ï–®–ï–ù–û** (HTTP WebFig –æ—Ç–∫–ª—é—á—ë–Ω v1.0)
- ‚úÖ CRIT-02: IPv6 Firewall - **–†–ï–®–ï–ù–û** (`firewall_complete.rsc` v1.2)
- ‚úÖ CRIT-03: Container Security - **–†–ï–®–ï–ù–û** (`nginx-certbot/` v1.2)
- ‚úÖ CRIT-04: DNS Resolver - **–†–ï–®–ï–ù–û** (`firewall_complete.rsc` v1.2)
- ‚úÖ MED-01: WiFi Security - **–†–ï–®–ï–ù–û** (`wifi/` v1.2)
- ‚úÖ MED-03: Firewall –ø–æ—Ä—è–¥–æ–∫ - **–†–ï–®–ï–ù–û** (`firewall_complete.rsc` v1.2)
- ‚úÖ MED-05: SSH Hardening - **–†–ï–®–ï–ù–û** (`firewall_complete.rsc` v1.2)
- ‚úÖ MED-06: SYN Flood Protection - **–†–ï–®–ï–ù–û** (`firewall_complete.rsc` v1.2)

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∏—Å–∫–∏ (–æ—Å—Ç–∞–ª–æ—Å—å)

1. ~~**CRIT-01: Credentials –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ**~~ - ‚úÖ **–†–ï–®–ï–ù–û –≤ v1.3** (—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
2. ~~**CRIT-02: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ IPv6 firewall**~~ - ‚úÖ —Ä–µ—à–µ–Ω–æ –≤ v1.2
3. ~~**CRIT-03: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å –∏–∑–±—ã—Ç–æ—á–Ω—ã–º–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏**~~ - ‚úÖ —Ä–µ—à–µ–Ω–æ –≤ v1.2
4. ~~**CRIT-04: –û—Ç–∫—Ä—ã—Ç—ã–π DNS resolver**~~ - ‚úÖ —Ä–µ—à–µ–Ω–æ –≤ v1.2
5. ~~**CRIT-05: –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å ACL —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è**~~ - ‚úÖ **–†–ï–®–ï–ù–û –≤ v1.3** (—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
6. ~~**CRIT-06: CVE-2025-61481 (HTTP WebFig)**~~ - ‚úÖ **–†–ï–®–ï–ù–û –≤ v1.0** (HTTP –æ—Ç–∫–ª—é—á—ë–Ω)

**üéâ –í–°–ï 6 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º —Ä–µ—à–µ–Ω—ã!** (100%)

---

## –û–±–∑–æ—Ä –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–µ—Ç–∏

```
                    Internet (PPPoE)
                          |
                    [R1-Core Router]
                          |
        +-----------------+------------------+
        |                 |                  |
    LAN Bridge      Management VLAN    Container Network
   192.168.1.0/24    172.16.99.0/24      10.11.0.0/24
        |                 |                  |
    +---+---+         +-------+      +-------+-------+
    |       |         | Mgmt  |      | xray  | nginx |
  WiFi   Devices    Devices  |      +-------+-------+
  VLAN20           |         |      | certbot       |
                   |         |      +---------------+
              Guest WiFi
              VLAN30
            10.30.0.0/24
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ |
|-----------|----------|-------------------|
| Base | –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, bridges, system services | `01-base.rsc` |
| WAN | PPPoE –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, –±–∞–∑–æ–≤—ã–π IPv4 firewall | `02-wan-pppoe-ipv4.rsc` |
| IPv6 | Hurricane Electric —Ç—É–Ω–Ω–µ–ª—å | `03-ipv6-HE-tunnel.rsc` |
| LAN/DHCP | –û—Å–Ω–æ–≤–Ω–∞—è —Å–µ—Ç—å, DHCP —Å–µ—Ä–≤–µ—Ä | `04-lan-dhcp.rsc` |
| Management VLAN | VLAN 99 –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è | `05-vlan-mgmt.rsc` |
| WiFi Core | CAPsMAN –æ—Å–Ω–æ–≤–Ω–∞—è —Å–µ—Ç—å | `06-wifi-capsman-core.rsc` |
| WiFi Guest | –ì–æ—Å—Ç–µ–≤–∞—è WiFi —Å –∏–∑–æ–ª—è—Ü–∏–µ–π | `07-wifi-guest—é.rsc` |
| Containers | Docker: xray, nginx, certbot | `08-containers.rsc` |
| BGP | –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ proxy | `09-bgp-proxy.rsc` |
| VPN SSTP | –£–¥–∞–ª—ë–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø | `10-vpn-sstp.rsc` |
| VPN S2S | WireGuard site-to-site | `11-vpn-site2site.rsc` |
| DNS DoH | DNS over HTTPS | `12-dns-doh.rsc` |
| DNS CA | –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ CA –¥–ª—è DoH | `12a-dns-doh-ca.rsc` |
| NTP | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ | `13-ntp.rsc` |
| Certificates | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ LE | `14-cert-renew.rsc` |

### –ù–æ–≤—ã–µ –º–æ–¥—É–ª–∏ (Version 1.2, 12 –¥–µ–∫–∞–±—Ä—è 2025)

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –§–∞–π–ª—ã |
|-----------|----------|-------|
| **Firewall Complete** | –ü–æ–ª–Ω—ã–π firewall (IPv4 + IPv6) | `firewall_complete.rsc` |
| **Nginx-Certbot** | Nginx reverse proxy + Let's Encrypt | `nginx-certbot/01-container-nginx-certbot.rsc`<br>`nginx-certbot/02-nginx-reverse-proxy.rsc` |
| **WiFi CAPsMAN** | Dual-stack (wifiwave2 + legacy) | `wifi/01-wifi-capsman.rsc`<br>`wifi/02-wifi-network.rsc`<br>`wifi/03-wifi-channels.rsc` |
| **WDS Bridge** | –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ Guest VLAN –Ω–∞ RB2011 | `wifi/04-r2-wds-ap-bridge.rsc`<br>`wifi/05-rb2011-wds-station-bridge.rsc` |
| **xRay VPN** | xRay proxy —Å BGP routing | `xray/01-xray-integration.rsc`<br>`xray/04-bgp-proxy.rsc` |

**–°—Ç–∞—Ç—É—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π:**
- ‚úÖ **firewall_complete.rsc** - –í—Å–µ P0 –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã (IPv6 firewall, –∏–∑–æ–ª—è—Ü–∏—è, rate limiting)
- ‚úÖ **nginx-certbot/** - Pinned –≤–µ—Ä—Å–∏–∏, resource limits, security headers
- ‚úÖ **wifi/** - WPA2+WPA3, —Ä–æ—É–º–∏–Ω–≥ 802.11k/r/v, client isolation
- ‚úÖ **WDS Bridge** - **12 –ø—Ä–æ–±–ª–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ** (CVSS 9.0 ‚Üí 2.5)
  - –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π firewall –≤–º–µ—Å—Ç–æ `remove [find]`
  - WPA2+WPA3 encryption
  - MAC filtering –Ω–∞ –æ–±–µ–∏—Ö —Å—Ç–æ—Ä–æ–Ω–∞—Ö
  - Management —á–µ—Ä–µ–∑ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π VLAN 99
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- ‚úÖ **xray/** - –£–ª—É—á—à–µ–Ω–Ω–∞—è BGP –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π:**
- [wifi/README.md](../wifi/README.md) - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ WiFi CAPsMAN
- [wifi/WDS-DEPLOYMENT-GUIDE.md](../wifi/WDS-DEPLOYMENT-GUIDE.md) - WDS Bridge deployment (150+ —Å—Ç—Ä–æ–∫)
- [nginx-certbot/README.md](../nginx-certbot/README.md) - Nginx + Let's Encrypt setup
- [xray/README.md](../xray/README.md) - xRay VPN proxy guide

---

## –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –∞—É–¥–∏—Ç–∞

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∏ best practices

1. **MikroTik Security Guidelines** (–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è 2025)
2. **OWASP Top 10** (–ø—Ä–∏–º–µ–Ω–∏—Ç–µ–ª—å–Ω–æ –∫ —Å–µ—Ç–µ–≤—ã–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º)
3. **CIS Benchmarks** –¥–ª—è network security
4. **NIST Cybersecurity Framework**
5. **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ Perplexity AI** (–∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞ 2025)

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã

- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á—ë—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ Firewall –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (IPv4 –∏ IPv6)
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç DDoS –∞—Ç–∞–∫
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å WiFi
- ‚úÖ VPN –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ patch management
- ‚úÖ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### ‚úÖ CRIT-01: –£—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ [SOLVED]

**Severity:** CRITICAL ‚Üí RESOLVED
**CVSS Score:** 9.8 (Critical) ‚Üí 0.0 (Resolved)
**CWE:** CWE-798 (Use of Hard-coded Credentials)
**Status:** ‚úÖ **–†–ï–®–ï–ù–û –≤ v1.3** - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–û–ø–∏—Å–∞–Ω–∏–µ (–∏—Å—Ö–æ–¥–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞):**
–£—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—Å—å –≤ plain text –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–ª–æ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ backup –∏–ª–∏ export –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏.

**‚úÖ –†–ï–®–ï–ù–ò–ï (v1.3):**
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π:

1. **`00-config.rsc`** - 130+ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (IP –∞–¥—Ä–µ—Å–∞, –ø–æ–¥—Å–µ—Ç–∏, VLAN IDs)
2. **`00-secrets.rsc`** - 40+ —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (–ø–∞—Ä–æ–ª–∏, –∫–ª—é—á–∏, credentials)
3. **`.gitignore`** - –∑–∞—â–∏—Ç–∞ —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –æ—Ç –∫–æ–º–º–∏—Ç–∞ –≤ Git
4. –í—Å–µ 19 –º–æ–¥—É–ª–µ–π –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è:**
```
00-config.rsc (–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞) ‚Üí :global cfg* –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
00-secrets.rsc (credentials)    ‚Üí :global sec* –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    ‚Üì
–í—Å–µ –º–æ–¥—É–ª–∏.rsc                  ‚Üí –ò—Å–ø–æ–ª—å–∑—É—é—Ç $cfg* –∏ $sec*
    ‚Üì
–ü–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞: /file remove 00-secrets.rsc (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –°–µ–∫—Ä–µ—Ç—ã –æ—Ç–¥–µ–ª–µ–Ω—ã –æ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ 00-secrets.rsc –ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—Å—è –≤ Git (.gitignore)
- ‚úÖ –û–¥–Ω–∞ –ø—Ä–∞–≤–∫–∞ –≤–º–µ—Å—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ 19 —Ñ–∞–π–ª–∞—Ö
- ‚úÖ –õ–µ–≥–∫–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–æ—É—Ç–µ—Ä–æ–≤
- ‚úÖ –ì–æ—Ç–æ–≤–æ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Ansible/Terraform

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** [CENTRALIZED-CONFIG-GUIDE.md](../CENTRALIZED-CONFIG-GUIDE.md)

**–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã (–∏—Å—Ö–æ–¥–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞):**

1. **`02-wan-pppoe-ipv4.rsc:4-5`**
   ```routeros
   :local PPP_USER "<PPPOE_USER>";
   :local PPP_PASS "<PPPOE_PASS>";
   ```
   **–†–∏—Å–∫:** –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è WAN –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

2. **`06-wifi-capsman-core.rsc:3`**
   ```routeros
   :local PASS "SuperSecretWiFi";
   ```
   **–†–∏—Å–∫:**
   - –°–ª–∞–±—ã–π –ø–∞—Ä–æ–ª—å (–Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç best practices)
   - –ù–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è WPA3-SAE
   - –í–∏–¥–∏–º –≤ `/export`

3. **`07-wifi-guest—é.rsc:3`**
   ```routeros
   :local GUEST_PASS "GuestPass1234";
   ```
   **–†–∏—Å–∫:**
   - –û—á–µ–Ω—å —Å–ª–∞–±—ã–π –ø–∞—Ä–æ–ª—å (dictionary attack)
   - –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω

4. **`10-vpn-sstp.rsc:13`**
   ```routeros
   /ppp secret add name="<SSTP_USER>" password="<SSTP_PASS>" ...
   ```
   **–†–∏—Å–∫:** VPN credentials –≤ plain text

5. **`11-vpn-site2site.rsc:7`**
   ```routeros
   :local LOCAL_PRIVKEY "<LOCAL_PRIVKEY_PLACEHOLDER>";
   ```
   **–†–∏—Å–∫:** WireGuard private key –≤ –∫–æ–Ω—Ñ–∏–≥–µ

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è (–∏—Å—Ö–æ–¥–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞):**
- –ù–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ç–∏
- Man-in-the-middle –∞—Ç–∞–∫–∏
- –ü–æ–ª–Ω–∞—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è VPN —Ç—É–Ω–Ω–µ–ª–µ–π
- –ö—Ä–∞–∂–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–í–µ–∫—Ç–æ—Ä –∞—Ç–∞–∫–∏ (–∏—Å—Ö–æ–¥–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞):**
1. –ü–æ–ª—É—á–µ–Ω–∏–µ backup —Ñ–∞–π–ª–∞ (—á–µ—Ä–µ–∑ —É—è–∑–≤–∏–º–æ—Å—Ç—å –∏–ª–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø)
2. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ credentials
3. –î–æ—Å—Ç—É–ø –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º—É —Å–µ—Ä–≤–∏—Å—É

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–∏—Å—Ö–æ–¥–Ω—ã–µ):**
- ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è credentials (00-secrets.rsc)
- ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û:** –ü—Ä–∏–º–µ–Ω—è—Ç—å .gitignore –¥–ª—è –∑–∞—â–∏—Ç—ã —Å–µ–∫—Ä–µ—Ç–æ–≤
- ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û:** –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
- üîÑ **–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø:** –ü—Ä–∏–º–µ–Ω—è—Ç—å encrypted backups (AES-256)
- üîÑ **–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø:** –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SSH keys –≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª–µ–π
- üîÑ **–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø:** –î–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö credentials - —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–Ω–µ —Ä–æ—É—Ç–µ—Ä–∞ (HashiCorp Vault)

**–°—Å—ã–ª–∫–∏:**
- [MikroTik: Securing Router](https://help.mikrotik.com/docs/spaces/ROS/pages/328353/Securing+your+router)
- [RouterOS Lockdown Guide](https://blog.exploit.org/caster-routeros-lockdown/)

---

### ‚úÖ CRIT-02: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç IPv6 Firewall [SOLVED]

**Severity:** CRITICAL
**CVSS Score:** 9.1 (Critical) ‚Üí 0.0 (Resolved)
**CWE:** CWE-693 (Protection Mechanism Failure)
**Status:** ‚úÖ **–†–ï–®–ï–ù–û** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `firewall_complete.rsc`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
IPv6 —Ç—É–Ω–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω (`03-ipv6-HE-tunnel.rsc`), –Ω–æ **–ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç** firewall –¥–ª—è IPv6 —Ç—Ä–∞—Ñ–∏–∫–∞. –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–æ—É—Ç–µ—Ä–∞ (SSH, Winbox, API) –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ IPv6 –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.

**–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã:**
- `03-ipv6-HE-tunnel.rsc` - —Ç—É–Ω–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ñ–∞–π–ª —Å IPv6 firewall –ø—Ä–∞–≤–∏–ª–∞–º–∏

**–¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```routeros
# 03-ipv6-HE-tunnel.rsc
/interface 6to4
add name=sit1 local-address=$WAN_PUBLIC_IP remote-address=$HE_REMOTE mtu=1280

/ipv6 address
add interface=sit1 address=$HE_LOCAL_ADDR advertise=no

/ipv6 route
add dst-address=2000::/3 gateway=$HE_REMOTE_GW

# IPv6 Firewall: –û–¢–°–£–¢–°–¢–í–£–ï–¢!
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:**
```bash
# –° –ª—é–±–æ–≥–æ —Ö–æ—Å—Ç–∞ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ —Å IPv6
nmap -6 -p 22,8291,8728 2001:470:6e:2b7::2

# –†–µ–∑—É–ª—å—Ç–∞—Ç: –≤—Å–µ –ø–æ—Ä—Ç—ã OPEN
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ management –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
- –û–±—Ö–æ–¥ IPv4 firewall –ø—Ä–∞–≤–∏–ª
- –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- Brute-force –∞—Ç–∞–∫–∏ –Ω–∞ SSH/Winbox —á–µ—Ä–µ–∑ IPv6

**–í–µ–∫—Ç–æ—Ä –∞—Ç–∞–∫–∏:**
1. –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ IPv6 –∞–¥—Ä–µ—Å–æ–≤ —Ä–æ—É—Ç–µ—Ä–∞
2. –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤ (22, 8291, 8728, 80, 443)
3. Brute-force –∏–ª–∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
4. –ü–æ–ª–Ω–∞—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è —Ä–æ—É—Ç–µ—Ä–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –°–æ–∑–¥–∞—Ç—å `/ipv6 firewall filter` –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ IPv4
- –ü—Ä–∏–º–µ–Ω–∏—Ç—å default-drop –ø–æ–ª–∏—Ç–∏–∫—É
- –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å management –¥–æ—Å—Ç—É–ø –ø–æ IPv6
- –î–æ–±–∞–≤–∏—Ç—å rate limiting

**–ü—Ä–∏–º–µ—Ä –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
```routeros
/ipv6 firewall filter
add chain=input connection-state=established,related action=accept
add chain=input connection-state=invalid action=drop
add chain=input protocol=icmpv6 action=accept
add chain=input in-interface-list=LAN action=accept
add chain=input action=drop comment="Drop all other IPv6 input"

add chain=forward connection-state=established,related action=accept
add chain=forward connection-state=invalid action=drop
add chain=forward action=drop comment="Drop all other IPv6 forward"
```

**–°—Å—ã–ª–∫–∏:**
- [MikroTik IPv6 Security](https://help.mikrotik.com/docs/display/ROS/IPv6)
- [NIST SP 800-119: IPv6 Security](https://csrc.nist.gov/publications/detail/sp/800-119/final)

**‚úÖ –†–µ—à–µ–Ω–∏–µ (v1.2):**
–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞ –≤ –º–æ–¥—É–ª–µ `firewall_complete.rsc`:
- –§–∞–π–ª: `/firewall_complete.rsc` (500+ —Å—Ç—Ä–æ–∫)
- –í–∫–ª—é—á–∞–µ—Ç: IPv6 INPUT chain, FORWARD chain, rate limiting, ND security
- –î–µ—Ç–∞–ª–∏: —Å–º. `docs/RECOMMENDATIONS.md` ‚Üí CRIT-02

---

### ‚úÖ CRIT-03: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å –∏–∑–±—ã—Ç–æ—á–Ω—ã–º–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏ [SOLVED]

**Severity:** CRITICAL
**CVSS Score:** 8.8 (High) ‚Üí 0.0 (Resolved)
**CWE:** CWE-250 (Execution with Unnecessary Privileges)
**Status:** ‚úÖ **–†–ï–®–ï–ù–û** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–¥—É–ª—å `nginx-certbot/`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏–º–µ—é—Ç –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Å–µ—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø –∫ —Ä–æ—É—Ç–µ—Ä—É, —á—Ç–æ –Ω–∞—Ä—É—à–∞–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø –∏–∑–æ–ª—è—Ü–∏–∏ –∏ —Å–æ–∑–¥–∞—ë—Ç —Ä–∏—Å–∫ –ø–æ–ª–Ω–æ–π –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏.

**–§–∞–π–ª:** `08-containers.rsc:59`

**–ü—Ä–æ–±–ª–µ–º–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```routeros
# –†–∞–∑—Ä–µ—à—ë–Ω –í–ï–°–¨ —Ç—Ä–∞—Ñ–∏–∫ –æ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∫ —Ä–æ—É—Ç–µ—Ä—É
/ip firewall filter
add chain=input src-address=10.11.0.0/24 action=accept \
    comment="Allow container internal management"
```

**–ß—Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:**
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ SSH (22)
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Winbox (8291)
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ API (8728, 8729)
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ WebFig (80, 443)

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `:latest` —Ç—ç–≥–æ–≤** (`08-containers.rsc:41-45`)
   ```routeros
   remote-image=teddysun/xray:latest
   remote-image=nginx:stable-alpine
   remote-image=certbot/certbot:latest
   ```
   **–†–∏—Å–∫:** –ù–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –≤–æ–∑–º–æ–∂–Ω–∞ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –æ–±—Ä–∞–∑–∞

2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ resource limits**
   - –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ –ø–∞–º—è—Ç–∏ (memory-high)
   - –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ CPU
   - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ DoS —Ä–æ—É—Ç–µ—Ä–∞

3. **–ü—É–±–ª–∏—á–Ω—ã–µ –ø–æ—Ä—Ç—ã –±–µ–∑ –∑–∞—â–∏—Ç—ã** (`08-containers.rsc:53-55`)
   ```routeros
   add chain=dstnat in-interface=pppoe-out1 protocol=tcp dst-port=80 \
       action=dst-nat to-addresses=$NGINX_IP
   add chain=dstnat in-interface=pppoe-out1 protocol=tcp dst-port=443 \
       action=dst-nat to-addresses=$NGINX_IP
   ```
   **–†–∏—Å–∫:**
   - –ù–µ—Ç rate limiting
   - –ù–µ—Ç connection tracking
   - –£—è–∑–≤–∏–º–æ—Å—Ç—å –∫ SYN flood, HTTP flood

**–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ MikroTik:**

> "Container feature in RouterOS has no security guarantee. If container is compromised,
> then the whole RouterOS can be compromised. It is possible to install malware which
> can persist even after Netinstall."

**–°—Ü–µ–Ω–∞—Ä–∏–π –∞—Ç–∞–∫–∏:**

1. –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ nginx/xray –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
2. –ü–æ–ª—É—á–µ–Ω–∏–µ shell –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
3. –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ ‚Üí –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ gateway (10.11.0.1)
4. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ RouterOS API (–ø–æ—Ä—Ç 8728 –æ—Ç–∫—Ä—ã—Ç!)
5. Brute-force –∏–ª–∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è CVE –≤ RouterOS
6. Root –¥–æ—Å—Ç—É–ø –∫ —Ä–æ—É—Ç–µ—Ä—É
7. –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è RouterBOOT ‚Üí persistence

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –ü–æ–ª–Ω–∞—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è —Ä–æ—É—Ç–µ—Ä–∞
- Pivot –≤ –¥—Ä—É–≥–∏–µ —Å–µ–≥–º–µ–Ω—Ç—ã —Å–µ—Ç–∏
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ backdoor —Å persistence
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—á–∏—Å—Ç–∫–∏ —á–µ—Ä–µ–∑ Netinstall

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –°—Ç—Ä–æ–≥–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è: –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã ‚Üí —Ä–æ—É—Ç–µ—Ä (whitelist)
- Pinned –≤–µ—Ä—Å–∏–∏ –æ–±—Ä–∞–∑–æ–≤
- Resource limits (memory-high, CPU)
- Rate limiting –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤
- Connection tracking –∏ limits

**‚úÖ –†–µ—à–µ–Ω–∏–µ (v1.2):**
–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞ –≤ –º–æ–¥—É–ª–µ `nginx-certbot/`:
- –§–∞–π–ª—ã: `/nginx-certbot/01-nginx-certbot-deploy.rsc` + `02-nginx-certbot-renew.rsc`
- Pinned –≤–µ—Ä—Å–∏–∏: nginx:1.25.3-alpine, certbot:v2.7.4
- Resource limits: memory-high —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- Firewall –∏–∑–æ–ª—è—Ü–∏—è: whitelist –¥–æ—Å—Ç—É–ø (DNS, NTP, syslog —Ç–æ–ª—å–∫–æ)
- Rate limiting: connection-limit + rate-limit –¥–ª—è –ø–æ—Ä—Ç–æ–≤ 80/443
- –î–µ—Ç–∞–ª–∏: —Å–º. `docs/RECOMMENDATIONS.md` ‚Üí CRIT-03

---

### ‚úÖ CRIT-04: –û—Ç–∫—Ä—ã—Ç—ã–π DNS Resolver [SOLVED]

**Severity:** HIGH
**CVSS Score:** 7.5 (High) ‚Üí 0.0 (Resolved)
**CWE:** CWE-406 (Insufficient Control of Network Message Volume)
**Status:** ‚úÖ **–†–ï–®–ï–ù–û** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `firewall_complete.rsc`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
DNS —Å–µ—Ä–≤–µ—Ä —Ä–æ—É—Ç–µ—Ä–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –æ—Ç –ª—é–±—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–º DNS amplification DDoS –∞—Ç–∞–∫.

**–§–∞–π–ª:** `12-dns-doh.rsc:3,6`

**–ü—Ä–æ–±–ª–µ–º–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```routeros
:local ALLOW_REMOTE_DNS yes;

/ip dns set allow-remote-requests=$ALLOW_REMOTE_DNS \
    use-doh-server=$DOH_URL verify-doh-cert=yes
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:**
```bash
# –° –≤–Ω–µ—à–Ω–µ–≥–æ —Ö–æ—Å—Ç–∞
dig @<ROUTER_PUBLIC_IP> example.com

# –ï—Å–ª–∏ –æ—Ç–≤–µ—á–∞–µ—Ç - —Ä–æ—É—Ç–µ—Ä —è–≤–ª—è–µ—Ç—Å—è open resolver
```

**–†–∏—Å–∫–∏:**

1. **DNS Amplification Attack**
   - –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç DNS –∑–∞–ø—Ä–æ—Å—ã —Å –ø–æ–¥–¥–µ–ª—å–Ω—ã–º source IP (–∂–µ—Ä—Ç–≤–∞)
   - –†–æ—É—Ç–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç –∂–µ—Ä—Ç–≤–µ –±–æ–ª—å—à–∏–º–∏ DNS –æ—Ç–≤–µ—Ç–∞–º–∏
   - Amplification factor: –¥–æ 54x

2. **–ü–µ—Ä–µ–≥—Ä—É–∑–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤**
   - DoH –∑–∞–ø—Ä–æ—Å—ã —Ç—Ä–µ–±—É—é—Ç HTTPS —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
   - –í—ã—Å–æ–∫–∞—è CPU –Ω–∞–≥—Ä—É–∑–∫–∞
   - –í–æ–∑–º–æ–∂–µ–Ω –æ—Ç–∫–∞–∑ –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏

3. **–£—Ç–µ—á–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏**
   - DNS query logs –º–æ–≥—É—Ç —Ä–∞—Å–∫—Ä—ã—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –¥–æ–º–µ–Ω—ã
   - –†–∞–∑–≤–µ–¥–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
–ü–æ –¥–∞–Ω–Ω—ã–º Cloudflare, –æ—Ç–∫—Ä—ã—Ç—ã–µ DNS resolvers –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ 95% DNS amplification –∞—Ç–∞–∫.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```routeros
# –û—Ç–∫–ª—é—á–∏—Ç—å remote requests –ø–æ–ª–Ω–æ—Å—Ç—å—é
/ip dns set allow-remote-requests=no

# –ò–ª–∏ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ —Å–µ—Ç—è–º–∏ —á–µ—Ä–µ–∑ firewall
/ip firewall filter
add chain=input protocol=udp dst-port=53 \
    src-address-list=!local-nets action=drop \
    comment="Block external DNS queries"
```

**‚úÖ –†–µ—à–µ–Ω–∏–µ (v1.2):**
–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞ –≤ –º–æ–¥—É–ª–µ `firewall_complete.rsc`:
- –§–∞–π–ª: `/firewall_complete.rsc`
- DNS –∑–∞–ø—Ä–æ—Å—ã —Ä–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π (address-list)
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ DNS –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (UDP + TCP –ø–æ—Ä—Ç 53)
- –î–µ—Ç–∞–ª–∏: —Å–º. `docs/RECOMMENDATIONS.md` ‚Üí CRIT-04

---

### ‚úÖ CRIT-05: –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å ACL —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è [SOLVED]

**Severity:** HIGH ‚Üí RESOLVED
**CVSS Score:** 7.3 (High) ‚Üí 0.0 (Resolved)
**CWE:** CWE-284 (Improper Access Control)
**Status:** ‚úÖ **–†–ï–®–ï–ù–û –≤ v1.3** - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–û–ø–∏—Å–∞–Ω–∏–µ (–∏—Å—Ö–æ–¥–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞):**
–°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –±—ã–ª–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã —Ç–æ–ª—å–∫–æ LAN –ø–æ–¥—Å–µ—Ç—å—é, –Ω–æ –Ω–µ –≤–∫–ª—é—á–∞–ª–∏ Management VLAN, —á—Ç–æ –¥–µ–ª–∞–ª–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã–º –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑ management —Å–µ–≥–º–µ–Ω—Ç–∞.

**‚úÖ –†–ï–®–ï–ù–ò–ï (v1.3):**
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ACL —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `cfgMgmtAllowedNets`:

**1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ 00-config.rsc:**
```routeros
# MANAGEMENT ACCESS (IP ranges allowed to access SSH/Winbox)
:global cfgMgmtAllowedNets [:toarray "192.168.1.0/24,172.16.99.0/24"]

# Best Practice –æ–ø—Ü–∏—è (–¢–û–õ–¨–ö–û Management VLAN):
# :global cfgMgmtAllowedNets [:toarray "172.16.99.0/24"]
```

**2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ 01-base.rsc:**
```routeros
# –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π
:local allowedNets [:tostr ($cfgMgmtAllowedNets->0)]
:for i from=1 to=([:len $cfgMgmtAllowedNets]-1) do={
    :set allowedNets ($allowedNets . "," . ($cfgMgmtAllowedNets->$i))
}

/ip service
set ssh address=$allowedNets port=22
set winbox address=$allowedNets port=8291
```

**3. Firewall –ø–æ–¥–¥–µ—Ä–∂–∫–∞:**
```routeros
# firewall_complete.rsc:74-75
add chain=input action=accept src-address=$MGMT_SUBNET_V4 \
    comment="Allow mgmt from MGMT subnet"
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –î–æ—Å—Ç—É–ø –∫ SSH/Winbox –∏–∑ –æ–±–µ–∏—Ö —Å–µ—Ç–µ–π (LAN + Management VLAN)
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –æ–¥–Ω—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
- ‚úÖ –õ–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –¢–û–õ–¨–ö–û Management VLAN (best practice)
- ‚úÖ Firewall –ø—Ä–∞–≤–∏–ª–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å ACL —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–¥—Å–µ—Ç–µ–π —á–µ—Ä–µ–∑ –º–∞—Å—Å–∏–≤

**–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã (–∏—Å—Ö–æ–¥–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞):**
- `01-base.rsc:24-25`
- `05-vlan-mgmt.rsc`

**–ü—Ä–æ–±–ª–µ–º–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**

```routeros
# 01-base.rsc
/ip service
set ssh address=192.168.1.0/24      # –¢–æ–ª—å–∫–æ LAN
set winbox address=192.168.1.0/24   # –¢–æ–ª—å–∫–æ LAN

# –ù–û! Management VLAN = 172.16.99.0/24 (–∏–∑ 05-vlan-mgmt.rsc)
# –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –≤ MGMT VLAN –ù–ï –º–æ–≥—É—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è!
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è (–∏—Å—Ö–æ–¥–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞):**
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π management —Å–µ—Ç–∏
- –ù–∞—Ä—É—à–µ–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ —Å–µ—Ç–∏
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –≤—ã–Ω—É–∂–¥–µ–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å –∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π LAN

**Best Practice –æ—Ç MikroTik:**
> "Use dedicated management VLAN, isolated from user traffic"

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–∏—Å—Ö–æ–¥–Ω—ã–µ):**
- ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û:** –î–æ–±–∞–≤–∏—Ç—å Management VLAN –≤ ACL —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û:** –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é cfgMgmtAllowedNets
- ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û:** Firewall –ø—Ä–∞–≤–∏–ª–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å ACL
- üîÑ **–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û:** –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –¢–û–õ–¨–ö–û Management VLAN (–¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)

**–ö–∞–∫ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –¢–û–õ–¨–ö–û Management VLAN (best practice):**
```routeros
# –í 00-config.rsc –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–æ–∫—É:
# :global cfgMgmtAllowedNets [:toarray "192.168.1.0/24,172.16.99.0/24"]

# –ò —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —ç—Ç—É:
:global cfgMgmtAllowedNets [:toarray "172.16.99.0/24"]
```

---

### ‚úÖ CRIT-06: CVE-2025-61481 Risk (HTTP WebFig) [SOLVED]

**Severity:** HIGH ‚Üí RESOLVED
**CVSS Score:** 8.1 (High) ‚Üí 0.0 (Resolved)
**CWE:** CWE-319 (Cleartext Transmission of Sensitive Information)
**Status:** ‚úÖ **–†–ï–®–ï–ù–û –≤ v1.0** - HTTP WebFig –æ—Ç–∫–ª—é—á—ë–Ω

**–û–ø–∏—Å–∞–Ω–∏–µ (–∏—Å—Ö–æ–¥–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞):**
CVE-2025-61481 –ø–æ–∑–≤–æ–ª—è–µ—Ç Remote Code Execution —á–µ—Ä–µ–∑ HTTP WebFig –∏–∑-–∑–∞ –ø–µ—Ä–µ–¥–∞—á–∏ credentials –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ (Base64).

**‚úÖ –†–ï–®–ï–ù–ò–ï:**
HTTP WebFig –æ—Ç–∫–ª—é—á—ë–Ω —Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞ –≤ –±–∞–∑–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```routeros
# 01-base.rsc:50-51
/ip service
set www disabled=yes        # ‚úÖ HTTP –æ—Ç–∫–ª—é—á—ë–Ω
set www-ssl disabled=yes    # ‚úÖ HTTPS —Ç–∞–∫–∂–µ –æ—Ç–∫–ª—é—á—ë–Ω (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
```

**–ó–∞—â–∏—Ç–∞ –æ—Ç CVE-2025-61481:**
- ‚úÖ HTTP WebFig –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á—ë–Ω
- ‚úÖ –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ –ø–æ—Ä—Ç 80
- ‚úÖ CVE –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ –∫ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ SSH (—Å strong-crypto) –∏ Winbox

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å):**
–ú–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –¢–û–õ–¨–ö–û HTTPS —Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –ø–æ IP:
```routeros
set www-ssl disabled=no address=172.16.99.0/24 certificate=router-cert
```

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ RouterOS:**
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ RouterOS –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ ‚Äî —ç—Ç–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–∏—Å—Ç–µ–º—ã, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ:
```routeros
# –ù–∞ —Ä–æ—É—Ç–µ—Ä–µ:
/system package update check-for-updates
/system package update download
# –ü–æ—Å–ª–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è:
/system reboot
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û:** HTTP WebFig –æ—Ç–∫–ª—é—á—ë–Ω
- ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (SSH, Winbox)
- üîÑ **–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û:** –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è RouterOS
- üîÑ **–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û:** –°–æ–∑–¥–∞–≤–∞—Ç—å encrypted backup –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏

---

## –°—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### üü° MED-01: WiFi Security (WPA2 only, –Ω–µ—Ç 802.11w)

**Severity:** MEDIUM
**File:** `06-wifi-capsman-core.rsc:10`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```routeros
/wifi security add name=sec-w2 authentication-types=wpa2-psk,wpa3-psk
```

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
1. WPA2-PSK –≤—Å—ë –µ—â—ë –¥–æ—Å—Ç—É–ø–µ–Ω (–ø–æ–¥–≤–µ—Ä–∂–µ–Ω KRACK –∞—Ç–∞–∫–∞–º)
2. –ù–µ—Ç 802.11w (Management Frame Protection) - –ø–æ–¥–≤–µ—Ä–∂–µ–Ω deauth –∞—Ç–∞–∫–∞–º
3. –ù–µ—Ç client isolation –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ç–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```routeros
/wifi security add name=sec-w2 \
    authentication-types=wpa3-psk \
    wpa2-pre-shared-key="strong-password" \
    group-encryption=aes-ccm \
    ft=yes \
    ft-preserve-vlanid=yes \
    management-protection=required
```

---

### üü° MED-02: BGP –±–µ–∑ –∑–∞—â–∏—Ç—ã

**Severity:** MEDIUM
**File:** `09-bgp-proxy.rsc:30-31`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```routeros
/routing bgp connection add name=$BGP_CONN_NAME \
    remote.address=$BGP_PEER_IP remote.as=$REMOTE_AS \
    # –ù–µ—Ç: tcp-md5-key, ttl-security, prefix-limit
```

**–†–∏—Å–∫–∏:**
- BGP session hijacking
- Prefix injection
- Route table overflow

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```routeros
/routing bgp connection set [find name=upstream-bgp] \
    tcp-md5-key="strong_bgp_password" \
    ttl=255 \
    input.limit-prefixes=100 \
    input.limit-prefixes-action=restart
```

---

### ‚úÖ MED-03: Firewall –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑ —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–Ω–∏—è [SOLVED]

**Severity:** MEDIUM ‚Üí RESOLVED
**File (—Å—Ç–∞—Ä—ã–π):** `07-wifi-guest—é.rsc:37-41`
**Status:** ‚úÖ **–†–ï–®–ï–ù–û –≤ v1.2** - firewall_complete.rsc

**–û–ø–∏—Å–∞–Ω–∏–µ (–∏—Å—Ö–æ–¥–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞):**
–í —Å—Ç–∞—Ä–æ–º —Ñ–∞–π–ª–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–æ–±–∞–≤–ª—è–ª–∏—Å—å –±–µ–∑ `place-before`, —á—Ç–æ –º–æ–≥–ª–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ—Ä–∞–±–æ—Ç–∞—é—â–µ–π –∏–∑–æ–ª—è—Ü–∏–∏:
```routeros
add chain=forward src-address=10.30.0.0/24 dst-address=192.168.1.0/24 \
    action=drop comment="Guest -> LAN block"
# ‚ùå –ù–µ—Ç place-before! –ú–æ–∂–µ—Ç –æ–∫–∞–∑–∞—Ç—å—Å—è –ü–û–°–õ–ï accept –ø—Ä–∞–≤–∏–ª
```

**–†–∏—Å–∫ (–∏—Å—Ö–æ–¥–Ω—ã–π):**
–ï—Å–ª–∏ –µ—Å—Ç—å –±–æ–ª–µ–µ —Ä–∞–Ω–Ω–µ–µ –ø—Ä–∞–≤–∏–ª–æ `action=accept`, guest –∏–∑–æ–ª—è—Ü–∏—è –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç.

**‚úÖ –†–ï–®–ï–ù–ò–ï (v1.2):**
–í `firewall_complete.rsc` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω **–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫** –ø—Ä–∞–≤–∏–ª:

1. Fasttrack (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
2. Accept established/related
3. Drop invalid
4. Allow LAN ‚Üí WAN
5. **Guest isolation (DROP)** ‚Üê –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ü–ï–†–ï–î —Ä–∞–∑—Ä–µ—à–∞—é—â–∏–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏
   ```routeros
   # firewall_complete.rsc:136-144
   add chain=forward action=drop src-address=$LAN_GUEST_V4 \
       dst-address=$LAN_MAIN_V4 \
       comment="Guest ‚Üí LAN block"
   add chain=forward action=drop src-address=$LAN_GUEST_V4 \
       dst-address=$MGMT_SUBNET_V4 \
       comment="Guest ‚Üí MGMT block"
   add chain=forward action=drop src-address=$LAN_GUEST_V4 \
       dst-address=$CONTAINER_SUBNET \
       comment="Guest ‚Üí Containers block"
   ```
6. Allow guest ‚Üí WAN (–∏–¥—ë—Ç –ü–û–°–õ–ï –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫: DROP –ø–µ—Ä–µ–¥ ACCEPT
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è place-before (–ø—Ä–∞–≤–∏–ª–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è firewall
- ‚úÖ –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º —Å–µ—Ç—è–º (Guest WiFi, VLAN 30)

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```routeros
/ip firewall filter print
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Guest isolation –ø—Ä–∞–≤–∏–ª–∞ –∏–¥—É—Ç –ü–ï–†–ï–î "Guest ‚Üí WAN allowed"
```

---

### üü° MED-04: NTP Server –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

**Severity:** MEDIUM
**File:** `13-ntp.rsc:9`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```routeros
/system ntp server set enabled=yes
# –î–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –í–°–ï–• - –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π NTP amplification
```

**–†–∏—Å–∫:** NTP amplification attack (factor –¥–æ 556x)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```routeros
# –û—Ç–∫–ª—é—á–∏—Ç—å NTP server –∏–ª–∏ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å firewall
/ip firewall filter
add chain=input protocol=udp dst-port=123 \
    src-address-list=!local-nets action=drop
```

---

### üü° MED-05: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç SSH hardening

**Severity:** MEDIUM
**File:** `01-base.rsc`

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ù–µ –≤–∫–ª—é—á—ë–Ω `strong-crypto` –¥–ª—è SSH.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```routeros
/ip ssh set strong-crypto=yes
```

---

### üü° MED-06: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç SYN flood –∑–∞—â–∏—Ç–∞

**Severity:** MEDIUM
**File:** –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```routeros
/ip settings set tcp-syncookies=yes
```

---

### üü° MED-07: MTU –¥–ª—è IPv6 —Ç—É–Ω–Ω–µ–ª—è —Å–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∏–π

**Severity:** LOW-MEDIUM
**File:** `03-ipv6-HE-tunnel.rsc:9`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```routeros
add name=sit1 ... mtu=1280
```

MTU 1280 –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—é. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 1472.

---

### üü° MED-08: Scheduler —Å –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–º /import

**Severity:** MEDIUM
**File:** `12a-dns-doh-ca.rsc:28`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```routeros
/system scheduler
add name="update-doh-ca" \
    on-event="/import 12a-dns-doh-ca.rsc"
```

–ï—Å–ª–∏ —Ñ–∞–π–ª –ø–æ–¥–º–µ–Ω—ë–Ω, –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –∫–æ–¥.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `/system script run` –≤–º–µ—Å—Ç–æ `/import`.

---

### üü° MED-09: –ß–∞—Å—Ç–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

**Severity:** LOW
**File:** `14-cert-renew.rsc:40`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```routeros
add name=cert-renew-sched interval=12h
```

12 —á–∞—Å–æ–≤ —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ. Let's Encrypt —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç —Ä–∞–∑ –≤ –¥–µ–Ω—å.

---

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### üîµ FUNC-01: –û–ø–µ—á–∞—Ç–∫–∞ –≤ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞

**File:** `07-wifi-guest—é.rsc`
**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:** `07-wifi-guest.rsc`

---

### üîµ FUNC-02: –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Å–∫—Ä–∏–ø—Ç–∞–º–∏

**File:** `07-wifi-guest—é.rsc:8`

```routeros
:local DNS "$LAN_GW";
```

–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `$LAN_GW` –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞, –µ—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** Hardcode –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.

---

### üîµ FUNC-03: Hardcoded –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

**File:** `07-wifi-guest—é.rsc:45`, `08-containers.rsc:54-55`

```routeros
out-interface=pppoe-out1  # Hardcoded
```

–ï—Å–ª–∏ WAN –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–∑–º–µ–Ω–∏—Ç—Å—è, –ø—Ä–∞–≤–∏–ª–∞ —Å–ª–æ–º–∞—é—Ç—Å—è.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–ª–∏ interface-list.

---

### üîµ FUNC-04: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è disk

**File:** `08-containers.rsc:6-8`

```routeros
:local IMAGE_TMPDIR "/disk1/tmp";
# –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏: :if ([/disk get 0 name] = "disk1")
```

---

### üîµ FUNC-05: –ù–µ—Ç error handling –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö

**File:** `14-cert-renew.rsc`, `12a-dns-doh-ca.rsc`

–°–∫—Ä–∏–ø—Ç—ã –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥.

---

## –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã

### ‚úÖ –•–æ—Ä–æ—à–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

1. **–ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** - –ª–æ–≥–∏—á–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Ñ–∞–π–ª—ã
2. **VLAN —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è** - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ LAN/Guest/Management
3. **Guest network isolation** - –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è –≥–æ—Å—Ç–µ–≤–æ–π —Å–µ—Ç–∏
4. **DoH –¥–ª—è DNS** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ DNS
5. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ CA** - –¥–ª—è DoH —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
6. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Let's Encrypt** - —á–µ—Ä–µ–∑ certbot
7. **–û—Ç–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤** - telnet, ftp, www
8. **VLAN-filtering –Ω–∞ bridge** - –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

---

## –ú–∞—Ç—Ä–∏—Ü–∞ —Ä–∏—Å–∫–æ–≤

| ID | –ü—Ä–æ–±–ª–µ–º–∞ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –†–∏—Å–∫ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°—Ç–∞—Ç—É—Å |
|----|----------|-------------|---------|------|-----------|--------|
| CRIT-01 | Credentials –≤ plain text | ~~–í—ã—Å–æ–∫–∞—è~~ | ~~–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ~~ | ‚úÖ –†–µ—à–µ–Ω–æ | ~~P0~~ | **v1.3** |
| CRIT-02 | –ù–µ—Ç IPv6 firewall | ~~–í—ã—Å–æ–∫–∞—è~~ | ~~–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ~~ | ‚úÖ –†–µ—à–µ–Ω–æ | ~~P0~~ | **v1.2** |
| CRIT-03 | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –±–µ–∑ –∏–∑–æ–ª—è—Ü–∏–∏ | ~~–°—Ä–µ–¥–Ω—è—è~~ | ~~–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ~~ | ‚úÖ –†–µ—à–µ–Ω–æ | ~~P0~~ | **v1.2** |
| CRIT-04 | Open DNS resolver | ~~–°—Ä–µ–¥–Ω—è—è~~ | ~~–í—ã—Å–æ–∫–æ–µ~~ | ‚úÖ –†–µ—à–µ–Ω–æ | ~~P1~~ | **v1.2** |
| CRIT-05 | ACL —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è | ~~–°—Ä–µ–¥–Ω—è—è~~ | ~~–í—ã—Å–æ–∫–æ–µ~~ | ‚úÖ –†–µ—à–µ–Ω–æ | ~~P1~~ | **v1.3** |
| CRIT-06 | CVE-2025-61481 (HTTP WebFig) | ~~–°—Ä–µ–¥–Ω—è—è~~ | ~~–í—ã—Å–æ–∫–æ–µ~~ | ‚úÖ –†–µ—à–µ–Ω–æ | ~~P1~~ | **v1.0** |
| MED-01 | WiFi WPA2 only | ~~–ù–∏–∑–∫–∞—è~~ | ~~–°—Ä–µ–¥–Ω–µ–µ~~ | ‚úÖ –†–µ—à–µ–Ω–æ | ~~P2~~ | **v1.2** |
| MED-02 | BGP –±–µ–∑ –∑–∞—â–∏—Ç—ã | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | üü° –°—Ä–µ–¥–Ω–∏–π | P2 | - |
| MED-03 | Firewall –ø–æ—Ä—è–¥–æ–∫ | ~~–°—Ä–µ–¥–Ω—è—è~~ | ~~–°—Ä–µ–¥–Ω–µ–µ~~ | ‚úÖ –†–µ—à–µ–Ω–æ | ~~P2~~ | **v1.2** |

---

## –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è

### ‚úÖ P0 - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π (–†–ï–®–ï–ù–û –≤ v1.2-1.3)

1. ‚úÖ **CRIT-02**: –°–æ–∑–¥–∞—Ç—å IPv6 firewall ‚Üí `firewall_complete.rsc` (v1.2)
2. ‚úÖ **CRIT-03**: –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ—Ç —Ä–æ—É—Ç–µ—Ä–∞ ‚Üí `firewall_complete.rsc` (v1.2)
3. ‚úÖ **CRIT-04**: –ó–∞–∫—Ä—ã—Ç—å DNS resolver ‚Üí `firewall_complete.rsc` (v1.2)
4. ‚úÖ **CRIT-01**: –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ credentials ‚Üí —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (v1.3)

### P1 - –í—ã—Å–æ–∫–∏–π (–≤—Å–µ —Ä–µ—à–µ–Ω–æ ‚úÖ)

5. ‚úÖ **CRIT-05**: –ò—Å–ø—Ä–∞–≤–∏—Ç—å ACL —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è ‚Üí —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (v1.3)
6. ‚úÖ **CRIT-06**: CVE-2025-61481 –∑–∞—â–∏—Ç–∞ ‚Üí HTTP WebFig –æ—Ç–∫–ª—é—á—ë–Ω (v1.0)
7. ‚úÖ **MED-05**: –í–∫–ª—é—á–∏—Ç—å SSH strong-crypto ‚Üí `firewall_complete.rsc` (v1.2)
8. ‚úÖ **MED-06**: –í–∫–ª—é—á–∏—Ç—å TCP syncookies ‚Üí `firewall_complete.rsc` (v1.2)
9. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å rate limiting –¥–ª—è –ø–æ—Ä—Ç–æ–≤ 80/443 ‚Üí `firewall_complete.rsc` (v1.2)

### P2 - –°—Ä–µ–¥–Ω–∏–π (—á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ—à–µ–Ω–æ)

10. ‚úÖ **MED-01**: –û–±–Ω–æ–≤–∏—Ç—å WiFi –¥–æ WPA3-only + 802.11w ‚Üí `wifi/*.rsc` (v1.2)
11. **MED-02**: –ó–∞—â–∏—Ç–∏—Ç—å BGP (MD5, TTL security)
12. ‚úÖ **MED-03**: –£–ø–æ—Ä—è–¥–æ—á–∏—Ç—å firewall –ø—Ä–∞–≤–∏–ª–∞ ‚Üí `firewall_complete.rsc` (v1.2)
13. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å fasttrack –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ‚Üí `firewall_complete.rsc` (v1.2)

### P3 - –ù–∏–∑–∫–∏–π (–ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)

13. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ–ø–µ—á–∞—Ç–∫—É –≤ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
14. –£–±—Ä–∞—Ç—å hardcoded –∑–Ω–∞—á–µ–Ω–∏—è
15. –î–æ–±–∞–≤–∏—Ç—å error handling –≤ —Å–∫—Ä–∏–ø—Ç—ã
16. –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–°–º. –¥–æ–∫—É–º–µ–Ω—Ç—ã:
- **RECOMMENDATIONS.md** - –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é
- **AUTOMATION_ARCHITECTURE.md** - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **IMPLEMENTATION_GUIDE.md** - –ø–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- **CONFIG_EXAMPLES/** - –≥–æ—Ç–æ–≤—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

---

## üìù Changelog –¥–æ–∫—É–º–µ–Ω—Ç–∞

### Version 1.2 (12 –¥–µ–∫–∞–±—Ä—è 2025)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª—è—Ö (firewall_complete, nginx-certbot, wifi, xray)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª "–ù–æ–≤—ã–µ –º–æ–¥—É–ª–∏" —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Å—Ç–∞—Ç—É—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ WDS Bridge (12 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º, CVSS 9.0 ‚Üí 2.5)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –º–æ–¥—É–ª–µ–π (15 ‚Üí 29+)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ –Ω–æ–≤—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (wifi/README.md, WDS-DEPLOYMENT-GUIDE.md)

### Version 1.1 (10 –¥–µ–∫–∞–±—Ä—è 2025)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ firewall_complete.rsc
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ IPv6 firewall

### Version 1.0 (10 –¥–µ–∫–∞–±—Ä—è 2025)
- ‚úÖ –ü–µ—Ä–≤–∏—á–Ω—ã–π –∞—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ 15 –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- ‚úÖ –í—ã—è–≤–ª–µ–Ω–æ 23 –ø—Ä–æ–±–ª–µ–º—ã (6 critical, 3 high, 9 medium, 5 low)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –º–∞—Ç—Ä–∏—Ü–∞ —Ä–∏—Å–∫–æ–≤ –∏ –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã

---

**–ö–æ–Ω–µ—Ü –¥–æ–∫—É–º–µ–Ω—Ç–∞**
*–°–ª–µ–¥—É—é—â–∏–π –¥–æ–∫—É–º–µ–Ω—Ç: RECOMMENDATIONS.md*
